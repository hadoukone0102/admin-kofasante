<!-- FILTER -->
<div class="row mb-4">
    <div class="mb-2 col-8 col-sm-4 btn-group">
        <button class="btn btn-github d-inline-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modal-form-filter">
            <i class="fa fa-table me-3"></i>
            Filtrer
        </button>
    </div>
    <div class="mb-2 col-8 col-sm-4  btn-group">
        <button (click)="resetFilter()" title="Réinitialiser le filtre"  class="btn btn-github d-inline-flex align-items-center" >
            <i class="fa fa-broom me-3"></i>
            Réinitialiser
        </button>
    </div>
    <div *ngIf="!isExporting && listType != 'failed'" class="mb-2 col-8 col-sm-4 btn-group">
        <button title="Affichez toute la liste pour exporter"  (click)="export()" type="button" class="btn btn-primary">Exporter</button>
    </div>
    <div  *ngIf="isExporting"  class="col-8 mb-2 col-sm-4  btn-group">
        <button title="Masquer le boutton d'exportation" (click)="this.search()" type="button" class="btn btn-primary">Masquer</button>
    </div>
    <div *ngIf="isExporting"  class="col-8 mb-2 col-sm-4 btn-group">
        <button type="button" class="btn btn-primary">Exporter en</button>
        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
          <svg class="icon icon-xs" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
          <span class="visually-hidden">Exporter en</span>
        </button>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" (click)="exportToPDF()">PDF</a></li>
          <li><a class="dropdown-item" (click)="exportToExel()">EXCEL</a></li>
        </ul>
      </div>

      <!-- Refresh -->
      <div class="col-8 mb-2 col-sm-4  btn-group">
          <app-refresh [isRefreshing]="isRefreshing"
          (toogleButton) = "handleToogleButtonFromChild($event)"
           ></app-refresh>
      </div>
      <!-- End Refresh -->
</div>

<!-- END FILTER -->

<div *ngIf="pageHasError" class="alert alert-danger alert-dismissible fade show" role="alert">
    <span class="fas fa-bullhorn me-1"></span>
    <strong>Erreur!</strong> {{errorMessage}}
    <button type="button" class="btn-close btn-sm" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>

<div  class="table-responsive">
    <table id="exportTable" class="table table-centered table-nowrap mb-0 rounded">
    <thead class="thead-light">
            <tr>
            <th class="border-0 rounded-start">N°</th>
            <th class="border-0">Jours</th>
            <th class="border-0">Dates</th>
            <th class="border-0">Heures et quêtes</th>
            <th *ngIf="!isExporting" class="border-0" >Actions</th>
        </tr>
    </thead>
<!-- ENABLED ACCOUNT -->
<!-- <tbody *ngIf="!isDisabledAccount()" [@boomTrigger]="admins.administrateurs.length"> -->
        <tbody>

            <!-- Item -->
            <tr *ngFor="let mass of massModel.masses; let i = index; trackBy: trackById" @linePaginateAnimation >
                <td><a  class="text-primary fw-bold">{{i+1}}</a> </td>
            <td >
                {{mass.days_name}}
            </td>   
            <td >
                {{mass.days | date:"dd/MM/yyyy"}}
            </td>   
            <td >
                <ng-container *ngFor="let time of mass.masses">
                    <strong>{{time.time | customTimeFormat}}</strong> [
                        <em *ngFor="let quest of time.QuestType">
                            {{quest}},
                        </em>
                    ],
                </ng-container>
            </td>
            
            <td *ngIf="!isExporting">
                <a title="Modifier" (click)="goToEditMass(mass.days_id)"  class="me-2 btn btn-sm btn-success d-inline-flex align-items-center">
                    <i class="fa fa-edit" ></i>
                </a>
                
                <a (click)="deleteMassDay(mass.days_id)" title="Supprimer le jour de messe et ses heures" class="btn btn-sm btn-danger d-inline-flex align-items-center">
                    <i class="fa fa-trash" ></i>
                </a>
            </td>
            
            </tr>
        <!-- End of Item -->
        </tbody>

    </table>

<div >
    <div *ngIf=" (massModel.last_page != 0 && massModel.last_page != undefined && massModel.last_page != -1) && !isExporting" class="card-footer px-3 border-0 d-flex flex-column flex-lg-row align-items-center justify-content-between">
        <p>
            Affichage de {{massModel.current_page}}/{{massModel.last_page}} pages
        </p>
        <nav  aria-label="Page navigation example">
            <ul class="pagination">
                <li class="page-item {{isFirstPage}}">
                <a (click)="goToPrevious()" class="page-link" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
                </li>
                <li class="page-item"><a class="page-link">{{massModel.current_page}}</a></li>
                <li  class="page-item {{isLastPage}}">
                <a (click)="goToNext()" class="page-link"  aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
                </li>
            </ul>
        </nav>
    </div>

    <!-- <h4 *ngIf="admins.administrateurs.length === 0" class="text-center mt-2">Aucune donnée dans la table</h4> -->
</div>

<!-- Spinner -->
<div class="text-center">
    <div *ngIf="spinner" class=" ms-3 d-flex align-items-center justify-content-center">
        <app-spinner></app-spinner>
    </div>
   </div>
   <!-- End spinner -->

<app-modal-filter
    [searchBarValue]="searchBarValue"
    [dateStartValue]="dateStartValue"
    [dateEndValue]="dateEndValue === ''? today: dateEndValue"
    listType="mass"
   (dataFilterToParent) = "handleDataFilterFromChild($event)"
   ></app-modal-filter>

</div>