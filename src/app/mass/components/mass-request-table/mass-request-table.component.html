<div class="row mb-4">
    <div *ngIf="(afficher)" class="mb-2 col-8 col-sm-4  btn-group">
        <button (click)="goToNoAnonymousMassRequest()" title="Réinitialiser le le filtre"  class="btn btn-success d-inline-flex align-items-center" >
            <i class="fa fa-eye me-3"></i>
            Non anonymes
        </button>
        <button  title="Réinitialiser le le filtre" (click)="goToAnonymousMassRequest()" class="btn btn-github d-inline-flex align-items-center" >
            <i class="fa fa-eye-slash me-3"></i>
            Anonymes
        </button>
    </div> 

    <div class="row mb-4">
        <div class="mb-2 col-8 col-sm-4 btn-group">
            <button class="btn btn-github d-inline-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modal-form-filter">
                <i class="fa fa-table me-3"></i>
                Filtrer
            </button>
        </div>
        <div class="mb-2 col-8 col-sm-4  btn-group">
            <button (click)="resetFilter()" title="Réinitialiser le le filtre"  class="btn btn-github d-inline-flex align-items-center" >
                <i class="fa fa-broom me-3"></i>
                Réinitialiser
            </button>
        </div>
        <div *ngIf="!showBtnExport" class="mb-2 col-8 col-sm-4  btn-group">
            <button (click)="export()" title="Réinitialiser le le filtre"  class="btn btn-primary d-inline-flex align-items-center" >
                <i class="fa fa-broom me-3"></i>
                Exporter
            </button>
        </div>

        <div *ngIf="showBtnExport" class="mb-2 col-8 col-sm-4  btn-group">
          <button  (click)="MasquerList()" title="Réinitialiser le le filtre"  class="btn btn-github d-inline-flex align-items-center" >
              <i class="fa fa-broom me-3"></i>
              Masquer
          </button>
        </div>

        <div *ngIf="showBtnExport" class="col-8 mb-2 col-sm-4 btn-group">
            <button type="button" class="btn btn-primary">Exporter en</button>
            <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
              <svg class="icon icon-xs" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
              <span class="visually-hidden">Exporter en</span>
            </button>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" (click)="exportToPDF()">PDF</a></li>
              <li><a class="dropdown-item" (click)="exportToExel()">EXCEL</a></li>
              <!-- <li><a class="dropdown-item" (click)="exportToCSV()">CSV</a></li> -->
              <!-- <li><hr class="dropdown-divider"></li> -->
              <!-- <li><a class="dropdown-item" href="#">Separated link</a></li> -->
            </ul>
        </div>

        <div *ngIf="listType != 'failed'" class="mb-2 col-8 col-sm-4  btn-group">
            <button title="Choisissez les colonnes à afficher"  class="btn btn-paypal d-inline-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modal-select-column">
                <i class="fa fa-check me-3"></i>
                Colonnes
            </button>
        </div>

        <!-- Refresh -->
        <div class="col-8 mb-2 col-sm-4  btn-group">
            <app-refresh [isRefreshing]="isRefreshing"
            (toogleButton) = "handleToogleButtonFromChild($event)"
             ></app-refresh>
        </div>
        <!-- End Refresh -->
    </div>
    
</div>

<!-- Le tableau des affichages  -->
<div  class="table-responsive">
    <table id="exportTable"  class="table table-centered table-nowrap mb-0 rounded">
        <thead class="thead-light">
            <tr>
                <th [ngClass]="{'d-none': !formDonationColumn.number}"  class="border-0 rounded-start">N°</th>
                <th [ngClass]="{'d-none': !formDonationColumn.nomDon}" class="border-0">Nom</th>
                <th [ngClass]="{'d-none': !formDonationColumn.prenomDon}" class="border-0">Prenom</th>
                <th [ngClass]="{'d-none': !formDonationColumn.contactDon}" class="border-0">Contact</th>
                <th [ngClass]="{'d-none': !formDonationColumn.typeDon}" class="border-0">Type de messe</th>
                <th [ngClass]="{'d-none': !formDonationColumn.intention}" class="border-0">Intention</th>
                <th [ngClass]="{'d-none': !formDonationColumn.dateDon}" class="border-0">Date</th>
                <th [ngClass]="{'d-none': !formDonationColumn.transactionId}" class="border-0">Id de transaction</th>
                <th *ngIf="showBtnExport" [ngClass]="{'d-none': !formDonationColumn.templateER}"class="border-0">Titre Intention</th>
            </tr>
        </thead>
<!-- ENABLED ACCOUNT -->
<!-- <tbody *ngIf="!isDisabledAccount()" [@boomTrigger]="admins.administrateurs.length"> -->
<tbody *ngFor="let request of messeList let i=index;">

    <!-- Item -->
    <tr [ngClass]="{'bg-secondary':request.isAnonymous===1, 'bg-tertiary text-white': request.isAnonymous!==1}"
        >

        <td *ngIf="formDonationColumn.number">
            {{i+1}}
        </td>
        <td  *ngIf="formDonationColumn.nomDon" (click)="setSelectedRequest(request.labelMt, request.templateER)" data-bs-toggle="modal" data-bs-target="#exampleModal">
            {{ request.lastNameMr }}
        </td>
        <td *ngIf="formDonationColumn.prenomDon" (click)="setSelectedRequest(request.labelMt, request.templateER)" data-bs-toggle="modal" data-bs-target="#exampleModal">
            {{ request.firstNameMr }}
        </td>
        <td *ngIf="formDonationColumn.contactDon">
            {{request.contactMr}}
        </td>
        <td *ngIf="formDonationColumn.intention">
            {{request.labelMt}}
        </td>
        <td *ngIf="formDonationColumn.typeDon" (click)="setSelectedRequest(request.labelMt, request.templateER)" data-bs-toggle="modal" data-bs-target="#exampleModal">
            {{request.type_demande}}
        </td>        
        <td  *ngIf="formDonationColumn.dateDon">
            <select [ngClass]="{'bg-secondary':request.isAnonymous===1, 'bg-tertiary text-white': request.isAnonymous!==1}">
                <option *ngFor="let masse of request.masses" [value]="masse.masses_days">
                    {{ (masse.masses_days | date:'dd/MM/yyyy') + ' ' + masse.masses_times }}
                </option>                
            </select>
        </td>
        <td *ngIf="formDonationColumn.transactionId">
            {{request.transaction_id}}
        </td>
        <ng-container *ngIf="showBtnExport">
            <td *ngIf="formDonationColumn.templateER">
                {{request.templateER}}
            </td>
        </ng-container>
    </tr>
<!-- End of Item -->

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">{{selectedRequestIntention}}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>
                    {{selectedTemplateER}}
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">fermer</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal -->
</tbody>

</table>
<div >
    
<div >
    <div *ngIf=" messeListParent.last_page != 0 && messeListParent.last_page != undefined && messeListParent.last_page != -1" class="card-footer px-3 border-0 d-flex flex-column flex-lg-row align-items-center justify-content-between">
        <p>
            Affichage de {{messeListParent.current_page}}/{{messeListParent.last_page}} pages
        </p>
        <nav  aria-label="Page navigation example">
            <ul class="pagination">
                <li class="page-item {{isFirstPage}}">
                <a (click)="goToPrevious()" class="page-link" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
                </li>
                <li class="page-item"><a class="page-link">{{messeListParent.current_page}}</a></li>
                <li  class="page-item {{isLastPage}}">
                <a (click)="goToNext()" class="page-link"  aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
                </li>
            </ul>
        </nav>
    </div>

    <!-- <h4 *ngIf="admins.administrateurs.length === 0" class="text-center mt-2">Aucune donnée dans la table</h4> -->
</div>
    <!-- <h4 *ngIf="admins.administrateurs.length === 0" class="text-center mt-2">Aucune donnée dans la table</h4> -->
</div>

<div *ngIf="(messeListParent.last_page === 0 || messeListParent.last_page === undefined) && !isExporting">
    <h4 class="text-center">Aucune donnée dans la table</h4>
</div>

<!-- Spinner -->
<div class="text-center">
<div *ngIf="messeListParent.last_page === -1" class=" ms-3 d-flex align-items-center justify-content-center">
    <app-spinner></app-spinner>
</div>
</div>
<!-- End spinner -->

<app-modal-filter
    [searchBarValue]="searchBarValue"
    [dateStartValue]="dateStartValue"
    [dateEndValue]="dateEndValue"
   (dataFilterToParent) = "handleDataFilterFromChild($event)"
></app-modal-filter>

<app-mass-modal-column
[listType]="listType"
(formDonationColumnToParent) = "handleDataColumnFromChild($event)"
>
</app-mass-modal-column>

</div>
